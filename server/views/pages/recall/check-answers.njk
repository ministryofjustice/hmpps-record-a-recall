{% extends "./prisonerBannerBackLayout.njk" %}

{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/inset-text/macro.njk" import govukInsetText %}

{% if createOrEdit == 'create' %}
    {% set title = "Check your answers" %}
{% else %}
    {% set title = "Recorded on " + (recallBeingEditted.createdAtTimestamp | formatDate) %}
{% endif %}
{% set pageTitle = applicationName + " - " + title %}
{% set pageCaption = "Record a recall" %}

{% block pageContent %}
    <h1 class="govuk-heading-l" id="check-answers-heading">{{ title }}</h1>



{% set checkAnswersRows = [
            {
                key: {
                    text: 'Date of revocation'
                },
                value: {
                    text: recall.revocationDate | formatDate
                },
                actions: {
                    items: [{
                        href: urls.revocationDate,
                        text: 'Edit'
                    }]
                }
            },
            {
                key: {
                    text: 'Arrest date'
                },
                value: {
                    text: 'In custody at revocation' if recall.inPrisonOnRevocationDate else (recall.returnToCustodyDate | formatDate) 
                },
                actions: {
                    items: [{
                        href: urls.returnToCustodyDate,
                        text: 'Edit'
                    }]
                }
            }
        ]
%}

{% if courtCasesCount != 0 %}
        {% set checkAnswersRows = (checkAnswersRows.push({
    
                key: {
                    text: 'Cases'
                },
                value: {
                    text: courtCasesCount + (' case'  | pluralise(courtCasesCount))
                },
                actions: {
                    items: [{
                        href: urls.manualSelectCases,
                        text: 'Edit'
                    }]
                }
            }), checkAnswersRows)
            
        %}

{% endif %}
        {% set checkAnswersRows = (checkAnswersRows.push(
            {
                key: {
                    text: 'Sentences'
                },
                value: {
                    text: recall.sentenceIds.length + (' sentence'  | pluralise(recall.sentenceIds.length))
                },
                actions: {
                    items: [{
                        href: urls.reviewSentences,
                        text: 'Review'
                    }]
                }
            }), checkAnswersRows)
        %}
        {% set checkAnswersRows = (checkAnswersRows.push(
            {
                key: {
                    text: 'Recall type'
                },
                value: {
                    text: recallTypeDescription
                },
                actions: {
                    items: [{
                        href: urls.recallType,
                        text: 'Edit'
                    }]
                }
            }), checkAnswersRows)            
        %}
    {{ govukSummaryList({
        attributes: { id: "check-answers" },
        rows: checkAnswersRows
    }) }}


    {% if ual %}
        {% set ualHtml %}
            These recall dates will create <b>{{ ual }} {{ 'day'  | pluralise(ual) }}</b> of UAL.
            Once you have confirmed and saved this recall, you can review all UAL dates in the adjustments service.
        {% endset %}
        {{ govukInsetText({
            id: 'ual-text',
            html: ualHtml
        }) }}
    {% endif %}

    <form method="post" action="">
        <input type="hidden" name="_csrf" value="{{ csrfToken }}">

        <div class="govuk-button-group">
            {{ govukButton({
                text: "Continue",
                preventDoubleClick: true,
                attributes: { id: "submit" }
            }) }}
            {{ govukButton({
                text: "Cancel",
                classes: "govuk-button--secondary",
                href: cancelUrl,
                attributes: { id: "cancel-button" }
            }) }}
        </div>
    </form>
{% endblock %}
