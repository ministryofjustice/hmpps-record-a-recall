{% extends "../../partials/prisonerBannerLayout.njk" %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/error-message/macro.njk" import govukErrorMessage %}

{% block content %}
  {# This backlink is custom-generated in the deleteRecallController to allow dynamic return paths (e.g., to overview or recalls list), it is not automatically generated by the form wizard. #}
  <a href="{{ backLink }}" class="govuk-back-link">Back</a>

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      {% if errors and errors.length %}
        {{ govukErrorSummary({
          titleText: "There is a problem",
          errorList: errors
        }) }}
      {% endif %}

      <h1 class="govuk-heading-xl">Are you sure you want to delete the recall?</h1>

      <div class="govuk-summary-card govuk-!-margin-bottom-6">
        <div class="govuk-summary-card__title-wrapper">
          <h2 class="govuk-summary-card__title">
            Recorded on {{ recall.createdAt | date }} at {{ recall.locationName or recall.createdByPrison or 'Unknown prison' }}
          </h2>
        </div>
        <div class="govuk-summary-card__content" id="recall-summary">
          <div class="govuk-grid-row govuk-!-padding-bottom-2 govuk-!-margin-top-2">
            <div class="govuk-grid-column-one-half">
              <h3 class="govuk-heading-s govuk-!-margin-bottom-1">Recall type</h3>
              <p class="govuk-body govuk-!-margin-bottom-2">{{ recall.recallType.description }}</p>
              <h3 class="govuk-heading-s govuk-!-margin-bottom-1">Date of revocation</h3>
              <p class="govuk-body govuk-!-margin-bottom-2">{{ recall.revocationDate | date }}</p>
            </div>
            <div class="govuk-grid-column-one-half">
              <h3 class="govuk-heading-s govuk-!-margin-bottom-1">Arrest date</h3>
              <p class="govuk-body govuk-!-margin-bottom-2">{{ recall.returnToCustodyDate | date if recall.returnToCustodyDate else 'Not entered' }}</p>
              <h3 class="govuk-heading-s govuk-!-margin-bottom-1">UAL (unlawfully at large)</h3>
              <p class="govuk-body govuk-!-margin-bottom-2">{{ recall.ualString if recall.ualString else 'None recorded' }}</p>
            </div>
          </div>
          <div class="govuk-!-margin-top-2">
            <a href="{{ recall.ualDetailsUrl }}">View UAL details</a>
          </div>
        </div>
      </div>

      <div class="govuk-visually-hidden">
        Deleting this recall will delete the 
        <strong>{{ recall.ual.days | default(0) }} day{{ recall.ual.days | default(0) | pluralize }}</strong> 
        of associated UAL. To delete tagged bail or remand time, please use the adjustments service.
      </div>


      <form method="post" action="/person/{{ nomisId }}/recall/{{ recall.recallId }}/delete">
        <input type="hidden" name="_csrf" value="{{ csrfToken }}">
        <input type="hidden" name="fromPage" value="{{ fromPage }}">
        <div class="govuk-form-group {%- if errors | findError('confirmDelete') %} govuk-form-group--error {%- endif %}">
          {{ govukErrorMessage(errors | findError('confirmDelete')) if errors | findError('confirmDelete') }}
          <fieldset class="govuk-fieldset">
            <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
              <span class="govuk-fieldset__heading">Are you sure?</span>
            </legend>
            <div class="govuk-radios">
              <div class="govuk-radios__item">
                <input class="govuk-radios__input" id="delete-yes" name="confirmDelete" type="radio" value="yes">
                <label class="govuk-label govuk-radios__label" for="delete-yes">Yes, delete the recall</label>
              </div>
              <div class="govuk-radios__item">
                <input class="govuk-radios__input" id="delete-no" name="confirmDelete" type="radio" value="no">
                <label class="govuk-label govuk-radios__label" for="delete-no">No, go back to recalls</label>
              </div>
            </div>
          </fieldset>
        </div>
        <button class="govuk-button" data-module="govuk-button" type="submit">Confirm</button>
      </form>

    </div>
  </div>
{% endblock %}
