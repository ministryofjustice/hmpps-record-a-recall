{% extends "./prisonerBannerBackLayout.njk" %}

{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}

{% set title = "Select the sentence type" %}
{% set pageTitle = applicationName + " - " + title %}
{% set pageCaption = "Record a recall" %}

{% block pageContent %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            <h1 class="govuk-heading-l">{{ title }}</h1>

            {% if sentence %}
                <p class="govuk-body">
                    {{ sentence.outcome }} - {% if sentence.offenceCode %}{{ sentence.offenceCode }} {% endif %}{% if sentence.offenceStartDate %}committed on {{ sentence.offenceStartDate }}{% endif %}
                </p>
            {% endif %}

            <form method="post">
                <input type="hidden" name="_csrf" value="{{ csrfToken }}">

                {% set fieldError = validationErrors | findError('sentenceType') %}

                {% set radioItems = [] %}
                {% for sentenceType in sentenceTypes %}
                    {% set radioItems = (radioItems.push({
                        value: sentenceType.sentenceTypeUuid,
                        text: sentenceType.description,
                        checked: formResponses.sentenceType === sentenceType.sentenceTypeUuid or selectedType === sentenceType.sentenceTypeUuid
                    }), radioItems) %}
                {% endfor %}

                {{ govukRadios({
                    id: "sentenceType",
                    name: "sentenceType",
                    fieldset: {
                        legend: {
                            text: "Select sentence type",
                            isPageHeading: false,
                            classes: "govuk-visually-hidden"
                        }
                    },
                    items: radioItems,
                    errorMessage: fieldError
                }) }}

                <div class="govuk-button-group">
                    {{ govukButton({
                        text: "Continue",
                        preventDoubleClick: true,
                        attributes: { id: "submit", "data-qa": "continue-button" }
                    }) }}
                    {{ govukButton({
                        text: "Cancel",
                        classes: "govuk-button--secondary",
                        href: cancelUrl,
                        attributes: { "data-qa": "cancel-link" }
                    }) }}
                </div>
            </form>
        </div>

        <div class="govuk-grid-column-one-third">
            <div class="court-case-details">
                <h2 class="govuk-heading-m">Court case details</h2>

                {% if courtCase %}
                    {% set rows = [] %}

                    {% if courtCase.reference %}
                        {% set rows = (rows.push({
                            key: {
                                text: "Case reference"
                            },
                            value: {
                                text: courtCase.reference
                            }
                        }), rows) %}
                    {% endif %}

                    {% set rows = (rows.push({
                        key: {
                            text: "Court name"
                        },
                        value: {
                            text: courtCase.courtName | safe
                        }
                    }), rows) %}

                    {% set rows = (rows.push({
                        key: {
                            text: "Warrant date"
                        },
                        value: {
                            text: courtCase.date
                        }
                    }), rows) %}

                    {% set rows = (rows.push({
                        key: {
                            text: "Overall case outcome"
                        },
                        value: {
                            text: "Imprisonment"
                        }
                    }), rows) %}

                    {{ govukSummaryList({
                        rows: rows
                    }) }}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
